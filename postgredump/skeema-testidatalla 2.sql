-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.

-- Skeema ja testidataa tauluille
-- laitoin nimiin _ että ei tule ongelmia varattujen sanojen kanssa (esim. Group)

DROP TABLE IF EXISTS Favoritelist_ CASCADE;
DROP TABLE IF EXISTS Group_ CASCADE;
DROP TABLE IF EXISTS Memberlist_ CASCADE;
DROP TABLE IF EXISTS Message_ CASCADE;
DROP TABLE IF EXISTS Profile_ CASCADE;
DROP TABLE IF EXISTS Review_ CASCADE;


CREATE TABLE IF NOT EXISTS Profile_
(
    profileid SERIAL PRIMARY KEY,
    profilename VARCHAR(255) UNIQUE NOT NULL,
    hashedpassword VARCHAR(255) NOT NULL,
    email text COLLATE pg_catalog."default",
    profilepicurl text COLLATE pg_catalog."default",
    "timestamp" TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    description text COLLATE pg_catalog."default"
);


CREATE TABLE IF NOT EXISTS Group_
(
    groupid SERIAL PRIMARY KEY,
    groupname VARCHAR(255) UNIQUE NOT NULL,
    groupexplanation text COLLATE pg_catalog."default",
    "timestamp" timestamp without time zone NOT NULL
);

-- mainuserissa 1 = ryhmän omistaja, 0 = jäsen
-- 0 = accepted, 1 = request sent to user , 2 = user tries to request join
CREATE TABLE IF NOT EXISTS Memberlist_
(
    memberlistid serial NOT NULL,
    profileid integer NOT NULL,
    mainuser integer NOT NULL DEFAULT 0,
    groupid integer NOT NULL,
    pending integer NOT NULL DEFAULT 0,
    FOREIGN KEY (profileid) REFERENCES Profile_(profileid),
    FOREIGN KEY (groupid) REFERENCES Group_(groupid)
);

CREATE TABLE IF NOT EXISTS Message_
(
    messageid serial NOT NULL,
    groupid integer NOT NULL,
    profileid integer NOT NULL,
    message text COLLATE pg_catalog."default" NOT NULL,
    "timestamp" timestamp without time zone NOT NULL,
    FOREIGN KEY (profileid) REFERENCES Profile_(profileid),
    FOREIGN KEY (groupid) REFERENCES Group_(groupid)
);

CREATE TABLE IF NOT EXISTS Favoritelist_
(
    idfavoritelist serial NOT NULL,
    profileid integer NOT NULL,
    groupid integer NOT NULL,
    favoriteditem text COLLATE pg_catalog."default" NOT NULL,
    showtime text COLLATE pg_catalog."default",
    "timestamp" timestamp without time zone NOT NULL,
    CONSTRAINT "Favoritelist_pkey" PRIMARY KEY (idfavoritelist),
    FOREIGN KEY (profileid) REFERENCES Profile_(profileid),
    FOREIGN KEY (groupid) REFERENCES Group_(groupid)
);

CREATE TABLE IF NOT EXISTS Review_
(
    idreview serial NOT NULL,
    profileid integer NOT NULL,
    revieweditem text COLLATE pg_catalog."default" NOT NULL,
    review text COLLATE pg_catalog."default",
    rating smallint NOT NULL,
    "timestamp" timestamp without time zone NOT NULL,
    FOREIGN KEY (profileid) REFERENCES Profile_(profileid)
);

ALTER TABLE IF EXISTS Favoritelist_
    ADD CONSTRAINT fk_groupid FOREIGN KEY (groupid)
    REFERENCES Group_ (groupid) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE;

ALTER TABLE IF EXISTS Favoritelist_
    ADD CONSTRAINT fk_profileid FOREIGN KEY (profileid)
    REFERENCES Profile_ (profileid) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE;

ALTER TABLE IF EXISTS Memberlist_
    ADD CONSTRAINT fk_groupid FOREIGN KEY (groupid)
    REFERENCES Group_ (groupid) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE;

ALTER TABLE IF EXISTS Memberlist_
    ADD CONSTRAINT fk_profileid FOREIGN KEY (profileid)
    REFERENCES Profile_ (profileid) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE;

ALTER TABLE IF EXISTS Message_
    ADD CONSTRAINT fk_groupid FOREIGN KEY (groupid)
    REFERENCES Group_ (groupid) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE;

ALTER TABLE IF EXISTS Message_
    ADD CONSTRAINT fk_profileid FOREIGN KEY (profileid)
    REFERENCES Profile_ (profileid) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE;

ALTER TABLE IF EXISTS Review_
    ADD CONSTRAINT fk_profileid FOREIGN KEY (profileid)
    REFERENCES Profile_ (profileid) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE;

INSERT INTO Profile_ (profilename, hashedPassword, email, profilepicurl, "timestamp", description) VALUES
-- testikäyttäjät id 1-10
-- Viilipytty hashaamaton salasana: oivamato
('Viilipytty', '$2b$10$Os132x/7gfQuEkIpTNvTG.XMrnQG/bOgj4AepLQ5u.wtgfEoTFpf.', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- Jankka hashaamaton salasana: 8D94gvds0
('Jankka', '$2b$10$ZarxfNZO1AYZp9VCg3Zjz.URJxUuZdcve5qd6A9QZQGWYRBln3rgm', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- komediaa82 hashaamaton salasana: aaidemok
('komediaa82', '$2b$10$9KLQoLOOd9PVGamFgdVoa.CoUDfXClGvAe6CCIW6vhdKbJfBzg89i', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- Eloton hashaamaton salasana: sana5532
('Eloton', '$2b$10$e8MfS6GQLuMWZnGyKowW7udiBNhys3/dH/YIgSbv3Z0MxggXBl9Lm', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- vainse hashaamaton salasana: rekku6
('vainse', '$2b$10$pYcfW1TE4lORryyRO6FJFOs8bF7m8ClPaXjDG/M/A4FsWVT917iDK', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- jokaToka hashaamaton salasana: lomakuume#1
('jokaToka', '$2b$10$QGlrHI60xCT1JkERYAYQYuiEuQCJAuaY.w9DVxNo2L6dpHNR2Me4G', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- Mikk0 hashaamaton salasana: VIEROSKAT
('Mikk0', '$2b$10$b9MMw4wALTbPDKXbgZIuJedz.tBhB1AAxBO21UW8gmVn34uvUDOEa', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- dramaqueen hashaamaton salasana: unohdettu1010
('dramaqueen', '$2b$10$SlZvRPqkAbEEO99f0gyRXubu/CKlkQo12ayYMyenik1ekELUtCc3W', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- kauhistus hashaamaton salasana: kauhuleffoja38
('kauhistus', '$2b$10$XrLUGUbR77BVtDPVZ6cLIOsmvltN20QLnzQ5vm8cWQjSPviNrjJiG', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- Jest4s hashaamaton salasana: )3nvds98ETF
('Jest4s', '$2b$10$IwMD52QfxJhT258LxwVNKeGGGDfix8oWApJt9Kd48DOGPhqbxi60K', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- testikäyttäjät id 11-20
-- AaveMaria hashaamaton salasana: #mvvdisCORD
('AaveMaria', '$2b$10$FC1jbhISaPnald7BczUTp.myptklA36L0ntNz4fdyedZprQ1X4aWq', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- siippa5 hashaamaton salasana: siipaton000
('siippa5', '$2b$10$is.bNU/5A4MdM9sZV/UdwO6qvMruQrfUbrkql371f9gmUs4TagBHa', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- Pastilli hashaamaton salasana: jukujes%
('Pastilli', '$2b$10$3bQI9aUHy9wx2qfulRDdRu94wo.m2RPcswnHNt126onZOwf3W.E3O', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- Huutista hashaamaton salasana: xDXDxdXD94
('Huutista', '$2b$10$m1A0mr3RqW.FejzJskU9iuS2SiDqcXpRpX3Da08TleGxP4b3gui8e', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- salaakaato hashaamaton salasana: tuskaa4=
('salaakaton', '$2b$10$RoF/XQbHpoLG8cm00ll/kuF1SUiLl/Vq0mEBio14./T.CfaGrh.F2', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- Kan-Joni hashaamaton salasana: helppo
('Kan-Joni', '$2b$10$8KeS4n.O2CLpUurqsQMBa.wej5SaNcSVC8XE9hl8uQ0Rj1lZzhN2a', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- poikamies hashaamaton salasana: vielkinEhtis
('poikamies', '$2b$10$MxjsY3EsB25IjGQJsUCpqOClHnsNISN1slbYkhc9zX0.JAhAMPxtO', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- Misu01 hashaamaton salasana: 987654321
('Misu01', '$2b$10$NI8.6kt3rXWmTTkb4uNZA.98JFcPnXm.AeLyNgB17V7aNWT.2tTQO', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- maitotee hashaamaton salasana: EnJuoKahvia
('maitotee', '$2b$10$BHetFB1YNwSCicx/I3YhE.2THqx2zBq1dzYr3enEKk4iSFOReVXuu', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- lipettiin hashaamaton salasana: somaprinsessa666
('lipettiin', '$2b$10$3IgL5lCJzcjp5HS0AWVcyOveJevU79cd9lNsPFvnWeECqT7YlNBf6', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- testikäyttäjät id 21 - 24
-- Jenna hashaamaton salasana: annejjenna
('Jenna', '$2b$10$DVgyW0Hc4jGIp/31Ck1oc.beiRyrR3DffdOGoFXrvWfShxeq9RjMu', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- Siilinpieru hashaamaton salasana: hedgehog
('Siilinpieru', '$2b$10$YWfQeOraJww3UCF3Ap0d6Of0bfnRn9uEJYdzuYfpLkAhyR2nyl0KK', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- PaijaanSUA hashaamaton salasana: byebye??0
('PaijaanSUA', '$2b$10$EOakCcZdU0hk/jxPajsGaeq1SVAJpDn56P6gXL63M3y6aPSruY9rS', NULL, NULL, CURRENT_TIMESTAMP, NULL),
-- UUUseri hashaamaton salasana: 123456
('UUUseri', '$2b$10$09CaL5r.JxvCl2rm2F5BBudYNinrgKKqPfcuVGEXJvdJwub0Q06te', NULL, NULL, CURRENT_TIMESTAMP, NULL)

INSERT INTO Group_ (groupname, groupexplanation, "timestamp") VALUES
-- id 1-5
('Ryhmärämä', 'kuvaus', CURRENT_TIMESTAMP),
('komediahullut', 'kuvaus', CURRENT_TIMESTAMP),
('tosimiesklubi', 'kuvaus', CURRENT_TIMESTAMP),
('Stadinrinki', 'kuvaus', CURRENT_TIMESTAMP),
('SOTA-leffat', 'kuvaus', CURRENT_TIMESTAMP),
-- id 6-10
('Draamailijat', 'kuvaus', CURRENT_TIMESTAMP),
('kauhalla kauhuu', 'kuvaus', CURRENT_TIMESTAMP),
('Tampereen seudun leffailijat', 'kuvaus', CURRENT_TIMESTAMP),
('Leffatiistai', 'kuvaus', CURRENT_TIMESTAMP),
('Vain-sarjoja', 'kuvaus', CURRENT_TIMESTAMP),
-- id 11-15
('Suomalaista filmii', 'kuvaus', CURRENT_TIMESTAMP),
('lastenleffat', 'kuvaus', CURRENT_TIMESTAMP),
('Äksönittäret', 'kuvaus', CURRENT_TIMESTAMP),
('Hevosaiheiset elokuvat', 'kuvaus', CURRENT_TIMESTAMP),
('Oulun oikeamieliset', 'kuvaus', CURRENT_TIMESTAMP);

INSERT INTO Memberlist_ (profileid, mainuser, groupid, pending) VALUES

-- Ryhmä Ryhmärämä
('1', 1, '1', 0),
('2', 0, '1', 0),
('3', 0, '1', 0),
('21', 0, '1', 0),
('22', 0, '1', 0),
('23', 0, '1', 0),
-- Ryhmä komediahullut
('4', 1, '2', 0),
('18', 0, '2', 0),
('3', 0, '2', 0),
('17', 0, '2', 0),
('20', 0, '2', 0),
-- Ryhmä tosimiesklubi
('5', 1, '3', 0),
('6', 0, '3', 0),
('11', 0, '3', 0),
('12', 0, '3', 0),
('13', 0, '3', 0),
-- Ryhmä Stadinrinki
('9', 1, '4', 0),
('7', 0, '4', 0),
('2', 0, '4', 0),
('8', 0, '4', 0),
('4', 0, '4', 0),
-- Ryhmä SOTA-leffat
('10', 1, '5', 0),
('15', 1, '5', 0),
('12', 0, '5', 0),
('16', 0, '5', 0),
('5', 0, '5', 0),
-- Ryhmä Draamailijat
('10', 1, '6', 0),
('21', 0, '6', 0),
('3', 0, '6', 0),
-- Ryhmä kauhalla kauhuu
('9', 1, '7', 0),
('14', 0, '7', 0),
('16', 0, '7', 0),
('12', 0, '7', 0),
('21', 0, '7', 0),
-- Ryhmä Tampereen seudun leffailijat
('12', 0, '8', 0),
('23', 1, '8', 0),
('2', 0, '8', 0),
('8', 0, '8', 0),
('7', 0, '8', 0),
-- Ryhmä Leffatiistai
('13', 0, '9', 0),
('10', 1, '9', 0),
('12', 0, '9', 0),
('23', 0, '9', 0),
-- Ryhmä Vain-sarjoja
('7', 1, '10', 0),
('2', 0, '10', 0),
('15', 0, '10', 0),
('10', 0, '10', 0),
-- Ryhmä Suomalaista filmii
('16', 0, '11', 0),
('18', 1, '11', 0),
('23', 0, '11', 0),
('21', 0, '11', 0),
('13', 0, '11', 0),
-- Ryhmä lastenleffat
('14', 1, '12', 0),
('16', 0, '12', 0),
('21', 0, '12', 0),
('2', 0, '12', 0),
-- Ryhmä Äksönittäret
('15', 1, '13', 0),
('22', 1, '13', 0),
('23', 0, '13', 0),
('10', 0, '13', 0),
('8', 0, '13', 0),
-- Ryhmä Hevosaiheiset elokuvat
('8', 1, '14', 0),
('7', 0, '14', 0),
('2', 0, '14', 0),
('16', 0, '14', 0),
('23', 0, '14', 0),
-- Ryhmä '15
('11', 1, '15', 0),
('10', 0, '15', 0),
('8', 0, '15', 0),
('18', 0, '15', 0),
('14', 0, '15', 0);

INSERT INTO Favoritelist_ (profileid, groupid, favoriteditem, showtime, "timestamp") VALUES
('1', '1', 'favorited_item_here', NULL, CURRENT_TIMESTAMP),
('2', '2', 'favorited_item_here', NULL, CURRENT_TIMESTAMP),
('3', '3', 'favorited_item_here', NULL, CURRENT_TIMESTAMP),
('4', '3', 'favorited_item_here', NULL, CURRENT_TIMESTAMP),
('5', '4', 'favorited_item_here', NULL, CURRENT_TIMESTAMP),
('6', '7', 'favorited_item_here', NULL, CURRENT_TIMESTAMP),
('7', '10', 'favorited_item_here', NULL, CURRENT_TIMESTAMP),
('8', '14', 'favorited_item_here', NULL, CURRENT_TIMESTAMP),
('9', '4', 'favorited_item_here', NULL, CURRENT_TIMESTAMP),
('10', '5', 'favorited_item_here', NULL, CURRENT_TIMESTAMP);

INSERT INTO Message_ (groupid, profileid, message, "timestamp") VALUES
('1', '1', 'Test message here', CURRENT_TIMESTAMP),
('2', '2', 'Test message here', CURRENT_TIMESTAMP),
('3', '3', 'Test message here', CURRENT_TIMESTAMP),
('4', '4', 'Test message here', CURRENT_TIMESTAMP),
('5', '5', 'Test message here', CURRENT_TIMESTAMP),
('6', '6', 'Test message here', CURRENT_TIMESTAMP),
('7', '7', 'Test message here', CURRENT_TIMESTAMP),
('8', '8', 'Test message here', CURRENT_TIMESTAMP),
('9', '9', 'Test message here', CURRENT_TIMESTAMP),
('10', '10', 'Test message here', CURRENT_TIMESTAMP),
('11', '11', 'Test message here', CURRENT_TIMESTAMP),
('12', '12', 'Test message here', CURRENT_TIMESTAMP),
('13', '13', 'Test message here', CURRENT_TIMESTAMP),
('14', '14', 'Test message here', CURRENT_TIMESTAMP),
('15', '15', 'Test message here', CURRENT_TIMESTAMP);

INSERT INTO Review_ (profileid, revieweditem, review, rating, "timestamp") VALUES
('1', 'reviewed_item_here', 'Test review', 5, CURRENT_TIMESTAMP),
('2', 'reviewed_item_here', 'Test review', 4, CURRENT_TIMESTAMP),
('3', 'reviewed_item_here', 'Test review', 3, CURRENT_TIMESTAMP),
('4', 'reviewed_item_here', 'Test review', 2, CURRENT_TIMESTAMP),
('5', 'reviewed_item_here', 'Test review', 4, CURRENT_TIMESTAMP),
('6', 'reviewed_item_here', 'Test review', 3, CURRENT_TIMESTAMP),
('7', 'reviewed_item_here', 'Test review', 5, CURRENT_TIMESTAMP),
('8', 'reviewed_item_here', 'Test review', 4, CURRENT_TIMESTAMP),
('9', 'reviewed_item_here', 'Test review', 3, CURRENT_TIMESTAMP),
('10', 'reviewed_item_here', 'Test review', 2, CURRENT_TIMESTAMP);

